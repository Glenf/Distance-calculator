var map,geocoder,bounds=new google.maps.LatLngBounds,markersArray=[],origin,destination,init=function(){var a={center:new google.maps.LatLng(65,24),mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:4};map=new google.maps.Map(document.getElementById("map"),a);geocoder=new google.maps.Geocoder},calculateDistance=function(){var a=new google.maps.DistanceMatrixService;origin=document.getElementById("origin").value+", Finland";destination=document.getElementById("destination").value+", Finland";a.getDistanceMatrix({origins:[origin],destinations:[destination],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1},callback)},callback=function(a,b){if(b!=google.maps.DistanceMatrixStatus.OK)alert("Virhe: "+b);else{var c=a.originAddresses,d=a.destinationAddresses,e=document.getElementById("outputDiv"),f;e.innerHTML="";deleteOverlay();for(var g=0;g<c.length;g++){f=a.rows[g].elements;addMarker(c[g]);for(var h=0;h<f.length;h++){e.innerHTML+=c[g]+" -> "+d[h]+": "+f[h].distance.text+". Aika "+f[h].duration.text+"<br />";addMarker(d[g])}}}},addMarker=function(a){geocoder.geocode({address:a},function(a,b){if(b==google.maps.GeocoderStatus.OK){bounds.extend(a[0].geometry.location);map.fitBounds(bounds);var c=new google.maps.Marker({map:map,position:a[0].geometry.location});markersArray.push(c)}else alert("Geocode was not successful for the following reason: "+b)})},deleteOverlay=function(){if(markersArray){for(i in markersArray)markersArray[i].setMap(null);markersArray.length=0}};